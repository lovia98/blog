---
title: 옵저버 패턴
author: 한주희
layout: post
icon: fa-angle-right
categories: patternArts
permalink: observer.html
---

옵져버 패턴은 신문이나 잡지처럼 데이터(목적)을 데이터가 필요한 쪽(구독자)에게 발행해주는 형식의 디자인을 말한다.

이름은 이와 맞지 않게 Observer(관찰자) 라고 붙여 있는데, 데이터를 필요로 하는 쪽 즉, 구독자가 
데이터가 변화할때나 혹은 주기적으로 데이터의 상태를 전달 받음으로서 '관찰'하는 형식이 되기 때문이다. 

따라서 이 패턴의 출발 과제는 데이터를 조회 하는 client객체와 데이터를 제공하는 객체간의 관계를 어떻게
디자인해야 하는지에 대한 고민이었다는 것을 알 수 있다.

버스 정류장의 곧 도착하는 버스알림 전광판을 예를 들어 보자. 

각 버스 정류장에서는 곧 도착할 버스 리스트가 **변경** 될 때 마다 전광판에 표시를 해줘야 한다.
전국의 버스 위치의 정보를 관리하는' 버스 위치 시스템'이 있는데, 각 버스 정류장에서는 곧 도착할 버스 리스트를
이 '버스 위치 시스템'를 통해서 곧 도착할 버스들의 리스트 정보를 얻어 올 수 있다.

버스 리스트가 언제 갱신 될지 모르므로 각 정류장에서 주기적으로 데이터를 조회한다고 하면, 데이터가 변경되지
않은 상황에서도 불필요하게 데이터를 조회하는 비용이 발생하게 되어 매우 비효율 적일 것이다.

거꾸로 '버스 위치 시스템'에서 버스 위치 정보가 변화할때마다 각 정류장으로 데이터를 전송해 준다면, 불필요한 비용을
막을 수 있을 것이다.

요즘 관심이 높아지고 있는 비동기 프로그래밍이나 spring-cloud진영의 유레카 같은 기능도 옵져버 패턴을 기반으로 하고 있다.

아까 옵져버 패턴은 신문이나 잡지와 같은 '구독' 의 형식을 취하고 있다고 했다.

'신문 구독'의 특징을 생각해 보자.
* 신문사가 사업을 시작하고 신문을 찍어낸다. (publish)
* 독자(describer)가 특정 신문사에 구독 신청을 하면 매번 새로운 신문을 배달 받는다.
* 신문을 더이상 받아보고 싶지 않으면 구독 해지 신청을 한다.
* 신문사가 계속 영업을 하는 이상 꾸준히 구독 및 해지를 하게 된다.

이와 같은 특성을 객체간의 관계에 적용한 것이 옵져버 패턴 이다.
![옵져버패턴을 적용한 객체관계]({{site.url}}/assets/images/pattern/observer-pattern.png)

> 옵저버 패턴의 정의 
  한 객체의 상태가 바뀌면 그 객체에 의존하는 다른 객체들한테 연락이 가고
  자동으로 내용이 갱신되는 방식으로 일대다(one-to-many) 의존성을 가지게 된다. 

![옵져버패턴을 적용한 객체관계]({{site.url}}/assets/images/pattern/observer-pattern1.png)

> 디자인 원칙
* 헐리우드 원칙 : 서로 상호작용을 하는 개체 사이에서는 가능하면 느슨하게 결합하는 디자인을 사용해야 한다.

